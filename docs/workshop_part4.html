<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.328">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DataSHIELD Workshop - Part 3: Data wranggling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<link href="./workshop_part3.html" rel="next">
<link href="./workshop_part2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Part 3: Data wranggling</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./">
      <img src="./logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">DataSHIELD Workshop</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/isglobal-brge/UnCoVer_workshop" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Share" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
            <i class="bi bi-bi-twitter pe-1"></i>
          Twitter
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
            <i class="bi bi-bi-facebook pe-1"></i>
          Facebook
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup.html" class="sidebar-item-text sidebar-link">Environment setup</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./help.html" class="sidebar-item-text sidebar-link">Get up to speed: Useful reads</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Workshop</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workshop_part0.html" class="sidebar-item-text sidebar-link">Part 0: Connecting to the analysis servers</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workshop_part1.html" class="sidebar-item-text sidebar-link">Part 1: Loading the data</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workshop_part2.html" class="sidebar-item-text sidebar-link">Part 2: Data validation</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workshop_part4.html" class="sidebar-item-text sidebar-link active">Part 3: Data wranggling</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workshop_part3.html" class="sidebar-item-text sidebar-link">Part 4: Descriptive analysis</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workshop_part5.html" class="sidebar-item-text sidebar-link">Part 5: Statistical models</a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercises.html" class="sidebar-item-text sidebar-link">Exercises</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-classes" id="toc-data-classes" class="nav-link active" data-scroll-target="#data-classes">Data classes</a></li>
  <li><a href="#complex-recoding.-number-of-comorbidities" id="toc-complex-recoding.-number-of-comorbidities" class="nav-link" data-scroll-target="#complex-recoding.-number-of-comorbidities">Complex recoding. Number of comorbidities</a></li>
  <li><a href="#complete-cases" id="toc-complete-cases" class="nav-link" data-scroll-target="#complete-cases">Complete cases</a></li>
  <li><a href="#dates" id="toc-dates" class="nav-link" data-scroll-target="#dates">Dates</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/isglobal-brge/UnCoVer_workshop/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Part 3: Data wranggling</h1>
</div>





<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div class="cell" data-hash="workshop_part4_cache/html/unnamed-chunk-1_499c694b2c07b0ed57849dc06a924955">

</div>
<p>We are now in the position to start working with the data. The first step is to learn how to manipulate it.</p>
<section id="data-classes" class="level2">
<h2 class="anchored" data-anchor-id="data-classes">Data classes</h2>
<p>All the tools to perform data transformations are the following:</p>
<ul>
<li><code>ds.asCharacter</code>: Useful to convert numerical values that we want as characters.</li>
<li><code>ds.asDataMatrixr</code>: Useful to convert <code>data.frames</code> into matrices, as some functions do not accept data frames as inputs. Maintains the original class for all columns.</li>
<li><code>ds.asMatrix</code>Useful to convert <code>data.frames</code> into matrices, as some functions do not accept data frames as inputs. Converts all columns into character class.</li>
<li><code>ds.asFactor</code>: May cause disclosure issues if we try to convert a continuous variable. Very useful when the loaded categorical variables are represented as <code>character</code> instead of <code>factor</code>.</li>
<li><code>ds.asInteger</code>: Useful when we require integer values, as the <code>class</code> numeric can’t guarantee it.</li>
<li><code>ds.asList</code>: Rarely used.</li>
<li><code>ds.asLogical</code>: To have <code>bool</code> variables. Similar to having <code>factor</code> variables.</li>
<li><code>ds.asNumeric</code>: Useful to convert columns that have been interpreted as <code>character</code> class but we want them as numbers.</li>
</ul>
<p>When we use all this functions, we will create a new object on the study servers. If we are dealing with a <code>data.frame</code> and want to include this new column we created into it, we can use the following code.</p>
<div class="cell" data-hash="workshop_part4_cache/html/newcol_b0b5719e8aa3b5f6707ae89eb217a1f0">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.asFactor</span>(<span class="at">input.var.name =</span> <span class="st">"data$CMXCVD"</span>, <span class="at">newobj.name =</span> <span class="st">"CMXCVD_factor"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$all.unique.levels
[1] "Yes" "No" 

$return.message
[1] "Data object &lt;CMXCVD_factor&gt; correctly created in all specified data sources"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>DSI<span class="sc">::</span><span class="fu">datashield.assign.expr</span>(connections, <span class="st">"data"</span>, <span class="st">"cbind(data, CMXCVD_factor)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will overwrite the input <code>data</code> object with an added column.</p>
<div class="cell" data-hash="workshop_part4_cache/html/seecol_fce71c9a34d0d26644b4a7df75e262d7">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(<span class="fu">ds.colnames</span>(<span class="st">"data"</span>)[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SMXSBA_numeric"   "SMXNAA_numeric"   "DMRGENDR_numeric" "DATAD_year"      
[5] "DATAD_year_day"   "CMXCVD_factor"   </code></pre>
</div>
</div>
</section>
<section id="complex-recoding.-number-of-comorbidities" class="level2">
<h2 class="anchored" data-anchor-id="complex-recoding.-number-of-comorbidities">Complex recoding. Number of comorbidities</h2>
<p>Given the available variables on our dataset, we might be interested on recoding variables or creating new variables as combinations of the existing ones. This is exactly what we will do here. We will take the comorbities: <code>CMXHT</code>, <code>CMXCVD</code>, <code>CMXCPD</code>, <code>CMXCKD</code>, <code>CMXCLD</code> and <code>RFXONC</code>.</p>
<p>We will create a new variable called <code>CMXCOM</code> that quantifies how many comorbidities an individual has. We will have four categories:</p>
<ul>
<li>0 comorbidities</li>
<li>1 comorbidities</li>
<li>2 comorbidities</li>
<li>3+ comorbidities</li>
</ul>
<p>The process to achieve this is not as easy as straightforward as it would be using base R functions on our computer.</p>
<p>To begin, we will take a look at how the variables are encoded. Looking at the codebook they should all be dicotomous variables encoded as <code>"Yes"</code> / <code>"No"</code>. We can verify that with the functions we’ve covered at the Part 2 of this workshop.</p>
<div class="cell" data-hash="workshop_part4_cache/html/comp_503f05b6c9694d68e1ade1507552dd63">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.table</span>(<span class="st">"data$CMXHT"</span>)<span class="sc">$</span>output.list<span class="sc">$</span>TABLES.COMBINED_all.sources_counts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Data in all studies were valid 

Study 1 :  No errors reported from this study
Study 2 :  No errors reported from this study</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>data$CMXHT
 Yes   No   NA 
 436  101 1977 </code></pre>
</div>
</div>
<p>Now, we will recode all the variabled so they are coded as <code>0</code> / <code>1</code>.</p>
<div class="cell" data-hash="workshop_part4_cache/html/recode_794f17624a38c8db44c26f427a8a53ef">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CMXHT"</span>, <span class="st">"CMXCVD"</span>, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">"CMXCPD"</span>, <span class="st">"CMXCKD"</span>, <span class="st">"CMXCLD"</span>, <span class="st">"RFXONC"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (x <span class="cf">in</span> variables){</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ds.recodeValues</span>(<span class="at">var.name =</span> <span class="fu">paste0</span>(<span class="st">"data$"</span>, x), </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">values2replace.vector =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>), </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">new.values.vector =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">newobj =</span> <span class="fu">paste0</span>(x, <span class="st">"_recoded"</span>))</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We have created a new object for each comorbiditie. The problem we now have is that the objects are of class <code>character</code>, because the <code>ds.recodeValues</code> function does not change the class.</p>
<div class="cell" data-hash="workshop_part4_cache/html/type_41f8bda1d1767b00df85f091d4a4b9ef">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.class</span>(<span class="st">"CMXHT_recoded"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$sc_verona
[1] "character"

$umf_cluj
[1] "character"</code></pre>
</div>
</div>
<p>Since we want to count the numbers of comorbidities for each individual, it is important that we have a <code>numeric</code> variable. As we have prevously seen we can easily obtain this.</p>
<div class="cell" data-hash="workshop_part4_cache/html/asnum_25bd3f24a8a26b05024a5ae3d9da71ff">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (x <span class="cf">in</span> variables){</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ds.asNumeric</span>(<span class="at">x.name =</span> <span class="fu">paste0</span>(x, <span class="st">"_recoded"</span>), </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">newobj =</span> <span class="fu">paste0</span>(x, <span class="st">"_recoded_num"</span>))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="workshop_part4_cache/html/type2_e06e976a566999e67942404a4b9ca917">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.class</span>(<span class="st">"CMXHT_recoded_num"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$sc_verona
[1] "numeric"

$umf_cluj
[1] "numeric"</code></pre>
</div>
</div>
<p>Now we have a collection of variables encoded as we want and ready to be combined. First, we will join them on a <code>data.frame</code>.</p>
<div class="cell" data-hash="workshop_part4_cache/html/df_9e2bf11c04024138ebdc80abdda1dc46">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.dataFrame</span>(<span class="at">x =</span> <span class="fu">paste0</span>(variables, <span class="st">"_recoded_num"</span>), </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">newobj =</span> <span class="st">"joint_comorbidities"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$is.object.created
[1] "A data object &lt;joint_comorbidities&gt; has been created in all specified data sources"

$validity.check
[1] "&lt;joint_comorbidities&gt; appears valid in all sources"</code></pre>
</div>
</div>
<p>On the server we have created a table that looks something like this:</p>
<table class="table">
<colgroup>
<col style="width: 18%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th>id</th>
<th>RFXOB_recoded_num</th>
<th>CMXDI_recoded_num</th>
<th>CMXHT_recoded_num</th>
<th>…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Individual 1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>…</td>
</tr>
<tr class="even">
<td>Individual 2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>…</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
</tbody>
</table>
<p>The variable we want to create is the amount of comorbidities by individual, therefore we have to perform <code>rowSums</code>.</p>
<div class="cell" data-hash="workshop_part4_cache/html/rowsums_7e344e94027c2975e84c805b2f52a5e8">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.rowColCalc</span>(<span class="at">x =</span> <span class="st">"joint_comorbidities"</span>, </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">operation =</span> <span class="st">"rowSums"</span>, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">newobj =</span> <span class="st">"new_variable"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are almost done, we will convert our new variable to be a <code>factor</code>.</p>
<div class="cell" data-hash="workshop_part4_cache/html/asf_df8e61faef7e8cc82ff2094547fb54b1">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.asFactor</span>(<span class="at">input.var.name =</span> <span class="st">"new_variable"</span>, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">newobj.name =</span> <span class="st">"new_variable_factor"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$all.unique.levels
[1] "0" "1" "2" "3" "4" "5"

$return.message
[1] "Data object &lt;new_variable_factor&gt; correctly created in all specified data sources"</code></pre>
</div>
</div>
<p>We can see that when we call the function <code>ds.asFactor</code> we receive the actual levels of the variable. We have said that the levels we actually want are <code>0, 1, 2, 3+</code>.</p>
<p>To achieve this we just have to re-code the levels.</p>
<div class="cell" data-hash="workshop_part4_cache/html/unnamed-chunk-2_f96b5c6dcd8fdd6e834967b090616314">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.recodeValues</span>(<span class="at">var.name =</span> <span class="st">"new_variable_factor"</span>, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">values2replace.vector =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span>),</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">new.values.vector =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>,<span class="st">"3+"</span>, <span class="st">"3+"</span>, <span class="st">"3+"</span>,<span class="st">"3+"</span>), </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">newobj =</span> <span class="st">"CMXCOM"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$is.object.created
[1] "A data object &lt;CMXCOM&gt; has been created in all specified data sources"

$validity.check
[1] "&lt;CMXCOM&gt; appears valid in all sources"</code></pre>
</div>
</div>
<p>Finally, we merge the new variable to our original data, and we are finished.</p>
<div class="cell" data-hash="workshop_part4_cache/html/join_7977336981007892ec2e24e3dd0d087c">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>DSI<span class="sc">::</span><span class="fu">datashield.assign.expr</span>(connections, <span class="st">"data"</span>, <span class="st">"cbind(data, CMXCOM)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="complete-cases" class="level2">
<h2 class="anchored" data-anchor-id="complete-cases">Complete cases</h2>
<p>Real data tends to have missing values, however, some specific tools or functions expect complete data as input. For that reason there is a function specifically for that. Let’s suppose we want to have the complete cases for the variables <code>DATAD</code> and <code>CMXHT</code>. First we join them on a new <code>data.frame</code>.</p>
<div class="cell" data-hash="workshop_part4_cache/html/newdf_35bd13035add8da8c8af9ffb85e09e3d">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.dataFrame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">"data$DATAD"</span>, <span class="st">"data$CMXHT"</span>), <span class="at">newobj =</span> <span class="st">"data_subset"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$is.object.created
[1] "A data object &lt;data_subset&gt; has been created in all specified data sources"

$validity.check
[1] "&lt;data_subset&gt; appears valid in all sources"</code></pre>
</div>
</div>
<p>Now we can get the complete cases.</p>
<div class="cell" data-hash="workshop_part4_cache/html/ccases_aafb39080d0023c98791a926452247d1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.completeCases</span>(<span class="at">x1 =</span> <span class="st">"data_subset"</span>, <span class="at">newobj =</span> <span class="st">"data_subset_ccases"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$is.object.created
[1] "A data object &lt;data_subset_ccases&gt; has been created in all specified data sources"

$validity.check
[1] "&lt;data_subset_ccases&gt; appears valid in all sources"</code></pre>
</div>
</div>
<p>We can check the dimensions before and after.</p>
<div class="cell" data-hash="workshop_part4_cache/html/dims_c8f8685b94e2ebf2d247cd614b86a537">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.dim</span>(<span class="st">"data_subset"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`dimensions of data_subset in sc_verona`
[1] 1515    2

$`dimensions of data_subset in umf_cluj`
[1] 999   2

$`dimensions of data_subset in combined studies`
[1] 2514    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.dim</span>(<span class="st">"data_subset_ccases"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`dimensions of data_subset_ccases in sc_verona`
[1] 269   2

$`dimensions of data_subset_ccases in umf_cluj`
[1] 252   2

$`dimensions of data_subset_ccases in combined studies`
[1] 521   2</code></pre>
</div>
</div>
</section>
<section id="dates" class="level2">
<h2 class="anchored" data-anchor-id="dates">Dates</h2>
<p>For this section we will use the HM Hospitales server, as it is the only one that has the prototype package installed.</p>
<div class="cell" data-hash="workshop_part4_cache/html/unnamed-chunk-3_e442990405db07ba65b49108603c4999">

</div>
<div class="cell" data-hash="workshop_part4_cache/html/unnamed-chunk-4_6005d3cce3fe6af98e115d13260743c3">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DSI)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DSOpal)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dsBaseClient)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dsDatesClient)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>builder <span class="ot">&lt;-</span> DSI<span class="sc">::</span><span class="fu">newDSLoginBuilder</span>()</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>builder<span class="sc">$</span><span class="fu">append</span>(<span class="at">server =</span> <span class="st">"hm_hospitales"</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">url =</span> <span class="st">"https://192.168.1.50:9002"</span>,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">user =</span> <span class="st">"user_analisis"</span>, <span class="at">password =</span> <span class="st">"Ekfl07UUgz"</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>logindata <span class="ot">&lt;-</span> builder<span class="sc">$</span><span class="fu">build</span>()</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr);<span class="fu">set_config</span>(<span class="fu">config</span>(<span class="at">ssl_verifypeer =</span> 0L))</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>connections <span class="ot">&lt;-</span> DSI<span class="sc">::</span><span class="fu">datashield.login</span>(<span class="at">logins =</span> logindata, <span class="at">failSafe =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Logging into the collaborating servers</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>DSI<span class="sc">::</span><span class="fu">datashield.assign.resource</span>(connections, <span class="st">"resource"</span>, <span class="st">"FiHM.harmonized_data"</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>DSI<span class="sc">::</span><span class="fu">datashield.assign.expr</span>(<span class="at">conns =</span> connections, <span class="at">symbol =</span> <span class="st">"data"</span>, <span class="at">expr =</span> <span class="st">"as.resource.data.frame(resource)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To begin working with dates, first we have to convert the columns that have the dates to the appropiate class. On the unCoVer codebook, the dates are encoded as strings with the structure <code>yyyy-mm-dd</code>, this does not hold for the HM Hospitales server, which has the dates encoded as <code>POSIXct</code>, for that reason first we will convert them to characters. In future versions this will be solved and we will be able to work with <code>POSIXct</code> data. We convert the columns using the <code>ds.asDate</code> function,</p>
<div class="cell" data-hash="workshop_part4_cache/html/unnamed-chunk-5_4e2e25eb1cc5360be8a00a9f90c218be">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.asCharacter</span>(<span class="st">"data$DATAD"</span>, <span class="st">"DATD_chr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$is.object.created
[1] "A data object &lt;DATD_chr&gt; has been created in all specified data sources"

$validity.check
[1] "&lt;DATD_chr&gt; appears valid in all sources"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>DSI<span class="sc">::</span><span class="fu">datashield.assign.expr</span>(connections, <span class="st">"data"</span>, <span class="st">"cbind(data, DATD_chr)"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.asCharacter</span>(<span class="st">"data$DATDS"</span>, <span class="st">"DATDS_chr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$is.object.created
[1] "A data object &lt;DATDS_chr&gt; has been created in all specified data sources"

$validity.check
[1] "&lt;DATDS_chr&gt; appears valid in all sources"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>DSI<span class="sc">::</span><span class="fu">datashield.assign.expr</span>(connections, <span class="st">"data"</span>, <span class="st">"cbind(data, DATDS_chr)"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.asDate</span>(<span class="at">x.name =</span> <span class="st">"data$DATD_chr"</span>, <span class="at">newobj =</span> <span class="st">"DATD_converted"</span>, <span class="at">datasources =</span> connections)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.asDate</span>(<span class="at">x.name =</span> <span class="st">"data$DATDS_chr"</span>, <span class="at">newobj =</span> <span class="st">"DATDS_converted"</span>, <span class="at">datasources =</span> connections)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now see that we have a column with the <code>Date</code> class.</p>
<div class="cell" data-hash="workshop_part4_cache/html/unnamed-chunk-6_7e8de73ba7452dc04bf24de59e15552f">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.class</span>(<span class="st">"data$DATD_converted"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$hm_hospitales
[1] "Date"</code></pre>
</div>
</div>
<p>Now we have two columns that contain dates in the correct class. With that, we can create a new column with the difference in days between the two dates.</p>
<div class="cell" data-hash="workshop_part4_cache/html/unnamed-chunk-7_2a5f2b275a83950b893ba22d0660a4c0">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.dateDiff</span>(<span class="st">"data$DATD_converted"</span>, <span class="st">"data$DATDS_converted"</span>, <span class="st">"difference"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.dateDiff</span>(<span class="st">"data$DATD_converted"</span>, <span class="st">"data$DATDS_converted"</span>, <span class="st">"difference"</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.quantileMean</span>(<span class="st">"data$difference"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code> Quantiles of the pooled data</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     5%     10%     25%     50%     75%     90%     95%    Mean 
 1.0000  2.0000  4.0000  7.0000 12.0000 20.0000 28.0000 10.0701 </code></pre>
</div>
</div>
<p>Also, we can perform subsets of the dataframe using dates.</p>
<div class="cell" data-hash="workshop_part4_cache/html/unnamed-chunk-8_593cda1f4e8115385a5e5f8ce004bb96">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.subsetByDate</span>(<span class="st">"data"</span>, <span class="st">"DATD_converted"</span>, <span class="at">year =</span> <span class="dv">2022</span>, <span class="at">newobj =</span> <span class="st">"data_subset"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$is.object.created
[1] "A data object &lt;data_subset&gt; has been created in all specified data sources"

$validity.check
[1] "&lt;data_subset&gt; appears valid in all sources"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.dim</span>(<span class="st">"data_subset"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`dimensions of data_subset in hm_hospitales`
[1] 549 225

$`dimensions of data_subset in combined studies`
[1] 549 225</code></pre>
</div>
</div>
<p>The subset function can be used for more complex queries.</p>
<div class="cell" data-hash="workshop_part4_cache/html/unnamed-chunk-9_cafb00d381c68105dc9da150f7db6cea">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.subsetByDate</span>(<span class="st">"data"</span>, <span class="st">"DATD_converted"</span>, <span class="at">year =</span> <span class="dv">2022</span>, <span class="at">month =</span> <span class="dv">4</span>, <span class="at">newobj =</span> <span class="st">"data_subset"</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.subsetByDate</span>(<span class="st">"data"</span>, <span class="st">"DATD_converted"</span>, <span class="fu">range</span>(<span class="st">"2021-05-23"</span>, <span class="st">"2021-09-25"</span>), <span class="at">newobj =</span> <span class="st">"data_subset"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="workshop_part4_cache/html/unnamed-chunk-10_045c1e62f9efbe3a83fdbbe8ed786cca">

</div>


</section>

</main> <!-- /main -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./workshop_part2.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Part 2: Data validation</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./workshop_part3.html" class="pagination-link">
        <span class="nav-page-text">Part 4: Descriptive analysis</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>